<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="pt-br">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>SQL - P4H  - Material</title>
    <meta name="generator" content="Hugo 0.22" />

    
    <meta name="description" content="Material do Curso de Programação para Ciências Sociais">
    
    <link rel="canonical" href="../sql/">
    
    <meta name="author" content="P4H">
    

    <meta property="og:url" content="/sql/">
    <meta property="og:title" content="P4H  - Material">
    <meta property="og:image" content="/logo_r4sc.jpg">
    <meta name="apple-mobile-web-app-title" content="P4H  - Material">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
    <link rel="stylesheet" href="../stylesheets/icons.css">
    <link rel="stylesheet" href="../stylesheets/application.css">
    <link rel="stylesheet" href="../stylesheets/temporary.css">
    <link rel="stylesheet" href="../stylesheets/palettes.css">
    <link rel="stylesheet" href="../stylesheets/prism.css">

    <link rel="stylesheet" href="../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="../javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        SQL
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/p4hUSP" title="@p4hUSP on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="../" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../logo_r4sc.jpg">
        </div>
      
      <div class="name">
        <strong>P4H  - Material </strong>
        
          <br>
          R4CS/site
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/R4CS/site/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/R4CS/site/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Introdução" href="../intro/">
	
	Introdução
</a>



  
</li>



<li>
  
    



<a  title="Gráficos" href="../ggplot2/">
	
	Gráficos
</a>



  
</li>



<li>
  
    



<a  title="Dplyr" href="../dplyr/">
	
	Dplyr
</a>



  
</li>



<li>
  
    



<a  title="Wrap Up" href="../wrapup/">
	
	Wrap Up
</a>



  
</li>



<li>
  
    



<a  title="Mapas" href="../mapas/">
	
	Mapas
</a>



  
</li>



<li>
  
    



<a  title="Web Scraping" href="../webscraping/">
	
	Web Scraping
</a>



  
</li>



<li>
  
    



<a class="current" title="SQL" href="../sql/">
	
	SQL
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Text Mining" href="../textmining/">
	
	Text Mining
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">Contatos</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/p4hUSP" target="_blank" title="@p4hUSP no GitHub">
              @p4hUSP no GitHub
            </a>
          </li>
          

          
          <li>
            <a href="https://facebook.com/p4hUSP" target="_blank" title="@p4hUSP on Facebook">
              @p4hUSP no Facebook
            </a>
          </li>
          

          
          <li>
            <a href="https://p4husp.herokuapp.com" target="_blank" title="@p4hUSP on Slack">
              @p4hUSP on Slack
            </a>
          </li>
          

          
          <li>
            <a href="mailto:programacao.sociais@gmail.com" title="Nosso E-Email programacao.sociais@gmail.com">
              Envie um E-Mail
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>SQL </h1>

			

<h2 id="r-dplyr-e-sql">R, dplyr e SQL</h2>

<h3 id="mysql-e-dplyr">MySQL e dplyr</h3>

<p>Uma das soluções mais simples para trabalharmos com bases de dados grandes em R é, em vez de carregar os dados na memória, conectar o R a uma fonte remota de dados e usar a gramática que aprendemos nos tutoriais anteriores para manipularmos os dados. Veremos a seguir um exemplo para dados em um servidor MySQL, mas ele vale para outros sistemas de gerenciamento de dados como PostgreSQL, MariaDB ou BigQuery. Vamos usar no tutorial uma adaptação do exemplo e dos dados do curso &ldquo;Data Manipulation in R with dplyr&rdquo;, organizado por Gareth Grolemund, no site Datacamp.</p>

<p>O MySQL não armazena os dados na memória RAM, mas no disco rígido. Isso expande bastante o limite do tamanho dos dados que conseguiremos gerenciar, sem, no entanto, precisar de outra &ldquo;gramática&rdquo; para manipulação de dados.</p>

<pre><code class="language-r">install.packages(&quot;RMySQL&quot;)
library(dplyr)
library(RMySQL)
</code></pre>

<p>O primeiro passo importante para trabalhar com dados em um servidor MySQL é fazer a conexão com uma base de dados. Vamos supor que temos um banco de dados (que, para o MySQL, significa um conjunto de tabelas, e não apenas uma tabela) chamado &ldquo;PBF&rdquo; em um servidor local, ou seja, no próprio computador, e que dentro desse banco de dados existe a tabela &ldquo;transferencias201701&rdquo;. O usuário e senha fictícias são, respectivamente, &ldquo;root&rdquo; e &ldquo;pass&rdquo;. Usamos, então, a função <em>src_mysql</em> para criar um objeto de &ldquo;conexão&rdquo;, que chamaremos de &ldquo;bd_mysql&rdquo;. Obviamente, o código abaixo não funcionará no seu computador, pois tal servidor não existe.</p>

<pre><code class="language-r">conexao &lt;- src_mysql(dbname = &quot;PBF&quot;, 
                   user = &quot;root&quot;,
                   password = &quot;pass&quot;)
</code></pre>

<p>A seguir, criamos um objeto &ldquo;tabela&rdquo;, que mantém a conexão direto com a tabela &ldquo;transferencias201701&rdquo; que está no banco de dados &ldquo;PBF&rdquo;.</p>

<pre><code class="language-r">tabela &lt;- tbl(conexao, &quot;pagamentos201701&quot;)
</code></pre>

<p>NOTA IMPORTANTE: nos testes que fizemos em sala de aula com uma conexão a um servidor PostgreSQL, tivemos que substituir o nome da tabela por um &ldquo;statment&rdquo; de SQL (veja <a href="https://github.com/tidyverse/dplyr/issues/244">Issue 244 no repo do dplyr</a> para a solução). Vamos supor que nossa tabela tenha o nome &ldquo;tabela&rdquo; e esteja num schema denominado &ldquo;schema&rdquo;. Para repetir o comando acima neste caso fazemos:</p>

<pre><code class="language-r">tabela &lt;- tbl(conexao, sql(&quot;SELECT * FROM schema.tabela&quot;))
</code></pre>

<p>Simples, não? A partir deste ponto, basta trabalhar com objeto &ldquo;tabela&rdquo; da mesma maneira que trabalhamos <em>data frames</em> até agora. A gramática oferecida pelo pacote <em>dplyr</em> funciona normalmente e, quando quisermos, podemos exportar os dados com os métodos acima.</p>

<h3 id="vôos-em-atraso-um-exemplo-do-site-datacamp">Vôos em atraso - um exemplo do site Datacamp</h3>

<p>Vamos ao exemplo do site Datacamp. Os códigos abaixo funcionarão normalmente no seu computador. O site Datacamp mantém um servidor remoto de MySQL que contém um banco de dados denominado &ldquo;dplyr&rdquo;. Esta, por sua vez, contém uma tabela também chamada &ldquo;dplyr&rdquo; (um pouco confuso, pois não precisaria ter o mesmo nome da base de dados) com informações sobre vôos de companhias aéreas.</p>

<p>Comecemos estabelecendo a conexão com o servidor e o banco de dados, tal como fizemos anteriormente. A diferença, agora, é que estamos lidando com um servidor remoto e por isso precisamos informar seu &ldquo;endereço&rdquo;. Fazemos isso preenchendo os argumentos &ldquo;host&rdquo; e &ldquo;port&rdquo;, cujos valores foram fornecidos pelos criadores do servidor, além, obviamente, do nome do banco de dados, usuário e senha (&ldquo;student&rdquo; e &ldquo;datacamp&rdquo;, respectivamente).</p>

<pre><code class="language-r">conexao &lt;- src_mysql(dbname = &quot;dplyr&quot;, 
                   host = &quot;courses.csrrinzqubik.us-east-1.rds.amazonaws.com&quot;, 
                   port = 3306, 
                   user = &quot;student&quot;,
                   password = &quot;datacamp&quot;)
</code></pre>

<p>Para ver todas as tabelas disponíveis na base de dados com a qual fizemos a conexão usamos:</p>

<pre><code class="language-r">src_tbls(conexao)
</code></pre>

<p>Uma vez conectados com o servidor, fazemos a conexão direta com a tabela &ldquo;dplyr&rdquo;, que é a que nos interessa. Vamos chamar o objeto criado de &ldquo;voos&rdquo;. Será este objeto que manipularemos com a gramática que aprendemos anteriormente.</p>

<pre><code class="language-r">voos &lt;- tbl(conexao, &quot;dplyr&quot;)
</code></pre>

<p>Você pode examinar o conteúdo de voos com as funções que já conhecemos: <em>head</em>, <em>str</em>, etc (Pela natureza do SQL, ele não nos retorna o número de observações, somente a de variáveis - mas isso é normal e você não precisa se preocupar com isso). Para o nosso exercício, vamos criar a variável &ldquo;atraso&rdquo;, que é a soma as variáveis atrasos de partidas e chegadas de cada vôo, respectivamente &ldquo;dep_delay&rdquo; e &ldquo;arr_delay&rdquo;. A seguir, vamos agrupar por companhia aérea (variável &ldquo;carrier&rdquo;), e calcular a soma agregada dos atrasos das companhias aéras. Tudo isso ser armazenado no objeto &ldquo;voos_atraso&rdquo;. Note que não há diferença alguma em relação ao que fizemos no passado, exceto o fato de que estamos trabalhando com os dados em um servidor remoto.</p>

<pre><code class="language-r">voos_atraso &lt;- voos %&gt;% 
  mutate(atraso =  dep_delay + arr_delay) %&gt;%
  group_by(carrier) %&gt;%
  summarise(total_atraso = sum(atraso))
</code></pre>

<h3 id="tradução-dplyr-sql">Tradução dplyr-SQL</h3>

<p>Podemos traduzir, literalmente, o comando acima para a linguagem de R para SQL como a função <em>show_query</em></p>

<pre><code class="language-r">show_query(voos_atraso)
</code></pre>

<p>O output, impresso no console, é a query equivalente que deveríamos produzir no MySQL para executar a mesma tarefa.</p>

<h3 id="outras-bases-de-dados">Outras bases de dados</h3>

<p>A conexão a outras bases de dados, MariaDb, SQLite, PostgreSQL e BigQuery, feita exatamente do mesmo modo que fizemos a conexão com um servidor de MySQL. Para as bases citadas usamos, respectivamente, as funções <em>scr_mysql</em> (sim, para MariaDB a função é a mesma que para MySQL), <em>scr_sqlite</em>, <em>scr_postgres</em> e <em>scr_bigquery</em> com os mesmos 5 argumentos que vimos acima: dbname, host, port, user e password.</p>

<p>Os verbos de manipulação de dados do pacote dplyr funcionam normalmente para tabelas nesses servidores.</p>

<h3 id="um-exemplo-com-mais-de-uma-tabela">Um exemplo com mais de uma tabela</h3>

<p>Vamos seguir com outro exemplo de manipulação de dados num servidor MySQL (novamente no servidor do Datacamp) para trabalhar com mais de uma tabela e reforçar o que vimos acima.</p>

<p>Comecemos com a conexão:</p>

<pre><code class="language-r">conexao &lt;- src_mysql(dbname = &quot;tweater&quot;, 
                   host = &quot;courses.csrrinzqubik.us-east-1.rds.amazonaws.com&quot;, 
                   port = 3306, 
                   user = &quot;student&quot;,
                   password = &quot;datacamp&quot;)
</code></pre>

<p><em>src_tables</em> fornece a listagem de tabelas na base de dados.</p>

<pre><code class="language-r">src_tbls(conexao)
</code></pre>

<p>Nessa base de dados há 3 tabelas com informações provenientes de uma rede social: &ldquo;users&rdquo;, que é uma tabela de usuários; &ldquo;tweats&rdquo; com informações sobre postagens de usuários; e &ldquo;comments&rdquo;, com comentários às postagens por outros usuários.</p>

<p>Se você sabe algo de SQL, pode usar a função <em>tbl</em> permite fazer <em>queries</em> em linguagem SQL. Por exemplo.</p>

<pre><code class="language-r">tbl(conexao, sql(&quot;SELECT * FROM comments WHERE user_id &gt; 4&quot;))
</code></pre>

<p>Mas queremos evitar o uso da linguagem SQL. Com <em>tbl</em>, criamos um objeto de tabela que seja manipulável com as funções do <em>dplyr</em>, sem, no entanto, importá-la. Vamos fazer isso para as três tabelas da base de dados que estamos usando:</p>

<pre><code class="language-r">comments &lt;- tbl(conexao, &quot;comments&quot;)

tweats &lt;- tbl(conexao, &quot;tweats&quot;)

users &lt;- tbl(conexao, &quot;users&quot;)
</code></pre>

<p>Repetindo a <em>query</em> acima, em que selecionamos na tabela <em>comments</em> apenas as linhas com <em>user_id</em> &gt; 4:</p>

<pre><code class="language-r">filter(comments, user_id &gt; 4)
</code></pre>

<p>A partir de agora, as funções de manipulação de dados do <em>dplyr</em> são aplicáveis aos novos objetos criados para representar as tabelas que estão no servidor. Por exemplo, vamos renomear a variável &ldquo;id&rdquo; em tweats para &ldquo;tweat_id&rdquo; e fazer um <em>left join</em> entre <em>comments</em> e <em>tweats</em> por &ldquo;tweat_id&rdquo;:</p>

<pre><code class="language-r">tweats2 &lt;- rename(tweats, tweat_id = id)

tabela_join &lt;- left_join(tweats2, comments, &quot;tweat_id&quot;)

head(tabela_join)
</code></pre>

<p>Note que &ldquo;tweats2&rdquo; é uma tabela gerada no servidor de SQL e não está na memória RAM de nosso computador.</p>

<p>Novamente, podemos traduzir a query de R para SQL:</p>

<pre><code class="language-r">show_query(tabela_join)
</code></pre>

<p>As funções da gramática do <em>dplyr</em> &ndash; <em>filter</em>, <em>select</em>, <em>rename</em>, <em>mutate</em>, <em>group_by</em>, <em>summarize</em>, <em>left_join</em>, <em>right_join</em>, <em>inner_join</em>, <em>full_join</em> e etc &ndash; funcionam normalmente à tabelas remotas e facilitam demais a manipulação. Um exemplo tolo, porém completo, usando o operador %&gt;% ( <em>pipe</em>, que permite omitir o primeiro argumento de cada função e nos poupa de repetir o nome da tabela diversas vezes) para ilustrar a aplicação de diversas funções do <em>dplyr</em> ao mesmo tempo:</p>

<pre><code class="language-r">tweats &lt;- tweats %&gt;% 
  rename(tweat_id = id) %&gt;%              # renomeia variavel
  mutate(post = toupper(post)) %&gt;%       # post em letras maiusculas
  left_join(comments, &quot;tweat_id&quot;) %&gt;%    # left join con tabela &quot;comments&quot;
  select(tweat_id, post, message) %&gt;%    # mantem apenas 3 variaveis
  mutate(n_caract = nchar(message)) %&gt;%  # cria var num caractecteres do comentario
  filter(n_caract &lt; 10)                  # filtra por comentarios com menos de 10 caract

head(tweats, 7)
</code></pre>

<p>Uma maneira simples de trazer à memória de seu computador a tabela gerada a partir da query, com <em>as.data.frame</em> importamos a tabela como <em>data frame</em>:</p>

<pre><code class="language-r">tabela &lt;- as.data.frame(tweats)
</code></pre>

<p>Note que &ldquo;tabela&rdquo;, diferentemente de &ldquo;tweats&rdquo;, é um <em>data frame</em> no seu <em>workspace</em>.</p>

<h3 id="tabelas-temporárias-versus-criação-de-tabelas-no-mysql">Tabelas temporárias <em>versus</em> criação de tabelas no MySQL</h3>

<p>Quando utilizamos os verbos do <em>dplyr</em> para manipulação de dados em servidor MySQL, todas as consultas são geradas como tabelas temporárias no servidor. Como fazer com que as consultas se tornem tabelas permanentes no servidor?</p>

<p>Vamos trabalhar com um servidor fictício, pois não temos permissão para gerar tabelas no servidor que utilizamos como exemplo no tutorial. Vamos supor que temos uma tabela &ldquo;pagamentos201701&rdquo; na nossa base de dados &ldquo;PBF&rdquo; e que tal tabela contém uma variável &ldquo;UF&rdquo; para unidades da federação:</p>

<pre><code class="language-r">conexao &lt;- src_mysql(dbname = &quot;PBF&quot;, 
                   user = &quot;root&quot;,
                   password = &quot;pass&quot;)

tabela &lt;- tbl(conexao, &quot;pagamentos201701&quot;)

minha_query &lt;- tabela %&gt;% 
  filter(UF == &quot;ES&quot;)
</code></pre>

<p>Ao produzir o comando acima, na prática, nada aconteceu. A execução da query só ocorrerá quando tentarmos trazer a tabela para a memória (&ldquo;fetch&rdquo;) ou explicitarmos que ela deve ser computada.</p>

<p>Se quisermos trazer os dados para a memória, utilizamos a função <em>collect</em>.</p>

<pre><code class="language-r">pagamentos_es &lt;- collect(minha_query)
</code></pre>

<p>Ao usar o comando <em>collect</em>, a query é executada no servidor e os dados enviados ao R.</p>

<p>O caminho inverso &ndash; subir ao servidor uma tabela &ndash; é feito com a função <em>copy_to</em></p>

<pre><code class="language-r">copy_to(dest = conexao, df = pagamentos_es, name = &quot;pagamentos201701_es&quot;)
</code></pre>

<p>No entanto, <em>copy_to</em> não geram uma nova tabela no servidor. Para que uma nova tabela seja gerada, é preciso definir o argumento &ldquo;temporary&rdquo; como &ldquo;FALSE&rdquo; (o padrão é &ldquo;TRUE&rdquo;):</p>

<pre><code class="language-r">copy_to(dest = conexao, df = pagamentos_es, name = &quot;pagamentos201701_es&quot;, temporary = FALSE)
</code></pre>

<p>Para executar a query no servidor sem que precisemos trazer a tabela e reenviá-la devemos usar a função <em>compute</em>, que também tem o argumento &ldquo;temporary&rdquo;.</p>

<pre><code class="language-r">compute(minha_query, name = &quot;pagamentos201701_es&quot;, temporary = FALSE)
</code></pre>

<p>Sem definir &ldquo;temporary&rdquo; como &ldquo;FALSE&rdquo;, a query será executada e a tabela gerada será temporária, apenas.</p>

<p>Tutorial elaborado originalmente por Leonardo Barone:
<a href="https://github.com/leobarone/FLS6397_2018/blob/master/tutorials/tutorial09a.Rmd">https://github.com/leobarone/FLS6397_2018/blob/master/tutorials/tutorial09a.Rmd</a></p>


			<aside class="copyright" role="note">
				
				&copy; 2019 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="../secs/" title="SECS 2018">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              SECS 2018
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="../wrapup/" title="Wrap Up">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Wrap Up
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '\/';
      var repo_id  = 'R4CS\/site';
    
    </script>

    <script src="../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-119683862-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="../javascripts/prism.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

